\ndocument.addEventListener('DOMContentLoaded', () => {\n    const promptInput = document.getElementById('prompt');\n    const sendButton = document.getElementById('send');\n    const generateImageButton = document.getElementById('generate-image'); // Nuevo bot贸n\n    const responseContainer = document.getElementById('response');\n    const statusContainer = document.getElementById('status');\n    const uploadedImage = document.getElementById('uploaded-image');\n\n    const setStatus = (text) => {\n        statusContainer.textContent = text || '';\n    };\n\n    const handleRecipeResponse = (recipe) => {\n        const title = document.createElement('h2');\n        title.textContent = recipe.title;\n\n        const ingredientsList = document.createElement('ul');\n        recipe.ingredients.forEach(ing => {\n            const li = document.createElement('li');\n            li.textContent = ing;\n            ingredientsList.appendChild(li);\n        });\n\n        const instructionsList = document.createElement('ol');\n        recipe.instructions.forEach(step => {\n            const li = document.createElement('li');\n            li.textContent = step;\n            instructionsList.appendChild(li);\n        });\n\n        responseContainer.innerHTML = '';\n        responseContainer.appendChild(title);\n        responseContainer.appendChild(document.createElement('h3')).textContent = 'Ingredients';\n        responseContainer.appendChild(ingredientsList);\n        responseContainer.appendChild(document.createElement('h3')).textContent = 'Instructions';\n        responseContainer.appendChild(instructionsList);\n    };\n\n    // --- L贸gica para Generar Receta ---\n    sendButton.addEventListener('click', async () => {\n        const userPrompt = promptInput.value;\n        if (!userPrompt) return;\n\n        setStatus('Generating recipe...');\n        responseContainer.innerHTML = '';\n\n        try {\n            const response = await fetch('/api/generate', {\n                method: 'POST',\n                headers: { 'Content-Type': 'application/json' },\n                body: JSON.stringify({ userPrompt, image: uploadedImage.dataset.imageName, mode: 'THINKING' })\n            });\n\n            if (!response.ok) {\n                throw new Error(`HTTP error! status: ${response.status}`);\n            }\n            const data = await response.json();\n\n            if (data.fallbackText) {\n                responseContainer.textContent = data.fallbackText;\n            } else {\n                handleRecipeResponse(data);\n            }\n\n        } catch (error) {\n            console.error('Error:', error);\n            responseContainer.textContent = 'Failed to generate response. See console for details.';\n        }\ finally {\n            setStatus('');\n        }\n    });\n\n    // --- L贸gica para Generar Imagen ---\n    generateImageButton.addEventListener('click', async () => {\n        const userPrompt = promptInput.value;\n        if (!userPrompt) return;\n\n        setStatus('Generating image...');\n        responseContainer.innerHTML = '';\n\n        try {\n            const response = await fetch('/api/generate-image', {\n                method: 'POST',\n                headers: { 'Content-Type': 'application/json' },\n                body: JSON.stringify({ prompt: userPrompt })\n            });\n\n            if (!response.ok) {\n                throw new Error(`HTTP error! status: ${response.status} ${await response.text()}`);\n            }\n\n            const data = await response.json();\n            \n            const img = document.createElement('img');\n            img.src = data.imageUrl;\n            img.style.maxWidth = '100%';\n            img.style.height = 'auto';\n\n            responseContainer.appendChild(img);\n\n        } catch (error) {\n            console.error('Error generating image:', error);\n            responseContainer.textContent = 'Failed to generate image. See console for details.';\n        } finally {\n            setStatus('');\n        }\n    });\n    \n    // ... (l贸gica de upload sin cambios)\n});\n